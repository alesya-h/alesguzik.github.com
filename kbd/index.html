<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Cyrillic Keyboard</title>
    <link rel="stylesheet" href="keyboard.css">
</head>
<body>
    <div id="page">
        <div class="main_content">
            <p id="action">
                <button type="button" id="selectAll">Select All</button>
                <button type="button" id="copy">Copy</button>
                <button type="button" id="undo">Undo</button>
                <button type="button" id="redo">Redo</button>
                <button type="button" id="clearAll">Clear All</button>
                <button type="button" title="Shrink letters" id="shrink">-</button>
                <button type="button" title="Enlarge letters" id="enlarge">+</button>
                <button type="button" id="langSwitch" title="Switch language (Ctrl+Shift), Esc for English" style="margin-left: 10px; font-weight: bold;">RU</button>
                <button type="button" id="addTextarea" style="margin-left: 10px;">+ Add Doc</button>
            </p>

            <div id="editor-container" class="editor-container">
                <!-- Textareas will be created dynamically -->
            </div>

            <div class="wrap-collapsible">
                <input id="collapsible" class="toggle" type="checkbox">
                <label for="collapsible" class="lbl-toggle">Keyboard & Info</label>
                <div class="collapsible-content">
                    <div class="content-inner">
                        <div id="keyboard"></div>
                        
                        <div class="info-section">
                            <p>This <em>Cyrillic Keyboard</em> enables you to easily type Russian and Belarusian online without installing a Cyrillic keyboard. You can use your computer keyboard or mouse to type Cyrillic letters with this online keyboard.</p>
                            <p>Press <span class="button">Ctrl+Shift</span> to switch between Russian and Belarusian layouts.</p>
                            <p>Pressing <span class="button">Esc</span> on the Cyrillic keyboard layout will toggle the mouse input between virtual QWERTY keyboard and virtual Cyrillic keyboard.</p>
                            <p>Press <span class="button">Shift</span> for additional Cyrillic letters that are not visible on the keyboard.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="charmaps.js"></script>
    <script src="keyboard.js"></script>
    <script>
        const langs = ['russian', 'belarusian'];
        const langNames = { russian: 'Russian', belarusian: 'Belarusian' };
        const langCodes = { russian: 'RU', belarusian: 'BY' };
        let currentLangIndex = 0;
        let keyboardInstance = null;

        function updateLangIndicator() {
            const lang = langs[currentLangIndex];
            const recessed = keyboardInstance.recessed;
            const baseCode = langCodes[lang];
            const langSwitch = document.getElementById('langSwitch');
            if (recessed) {
                langSwitch.innerHTML = `${baseCode} <span style="font-weight:normal">(en)</span>`;
            } else {
                langSwitch.textContent = baseCode;
            }
        }

        function switchLanguage() {
            currentLangIndex = (currentLangIndex + 1) % langs.length;
            const lang = langs[currentLangIndex];
            
            keyboardInstance.charMap = charMaps[lang];
            keyboardInstance.build();
            updateLangIndicator();
        }

        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.shiftKey) {
                event.preventDefault();
                switchLanguage();
            }
        });

        document.getElementById('langSwitch').addEventListener('click', switchLanguage);

        keyboardInstance = new Keyboard({
            charMap: charMaps.russian,
            onRecessedChange: function(recessed) {
                updateLangIndicator();
            }
        });
    </script>
</body>
</html>
